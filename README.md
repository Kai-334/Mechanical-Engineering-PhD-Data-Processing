# Mechanical Engineering PhD Data Processing

This repository contains MATLAB scripts for processing and analyzing wave propagation data as part of my mechanical engineering PhD research.

![Description of Image]([https://github.com/Kai-334/Mechanical-Engineering-PhD-Data-Processing/blob/40c670d700873926d18c4d8237f56b9389e6957e/Surface%20vs%20Cross%20Section.png](https://github.com/Kai-334/Mechanical-Engineering-PhD-Data-Processing/blob/727d240c4ed960f26c7a240b0d55a19a438eccf3/Setup%20Configuration.png))

## Project Overview

The scripts perform the following tasks:

- **Data Importing:** Reading and preprocessing raw acoustic emission data from simulations or experiments.
- **Data Visualization:** Visualizing raw and filtered wave data in both time-space and frequency-wavenumber domains.
- **Signal Processing:** Applying digital filters and time-gating to enhance signal quality and focus on regions of interest.
- **FFT Analysis:** Performing 2D Fast Fourier Transform (FFT) analysis to convert time-space data into frequency-wavenumber representations.
- **Dispersion Curve Overlay:** Overlaying theoretical dispersion curves onto FFT results for comparison and validation.
- **Participating Factor Calculation:** Calculating participating factors for different wave modes to quantify their contributions.

## File Structure

- `src/`: Contains all MATLAB scripts.
- `data/`: Contains input data files required for the analysis.
- `figures/`: (Optional) Stores generated figures.

```
- data-analysis-project/
  - README.md
  - src/
    - main_script.m
    - data_import.m
    - data_visualization.m
    - data_filtering.m
    - time_gating.m
    - apply_hann_window.m
    - fft_analysis.m
    - plot_dispersion_curves.m
    - extract_modes.m
    - extract_modes_with_displacement.m
    - scaling_matrix.m
    - compute_participating_factor.m
  - data/
    - V22.mat
    - A0.mat
    - S0.mat
    - (other .mat files)
  - figures/
    - (optional: save generated figures here)
```

## Getting Started

1. **Clone the repository:**
   ```bash
   git clone https://github.com/yourusername/data-analysis-project.git
   
2. **Install MATLAB:**
   
   Ensure that MATLAB is installed on your system, along with the required toolboxes.
   
3. **Prepare Data Files:**
   
   Place your data files (e.g., `V22.mat`, `A0.mat`, `S0.mat`) in the `data/` directory.
   
4. **Run the Main Script:**
   
   Open MATLAB and navigate to the `src/` directory. Run the `main_script.m` file.


## Dependencies

- MATLAB R2020a or later.
- Signal Processing Toolbox.

## Usage

Modify the parameters in `main_script.m` as needed, such as file paths, analysis settings, and data processing options.

**Example Parameters to Adjust:**

- **Data File Name:** Specify the name of the data file to import.
- **Filter Settings:** Adjust the order and cutoff frequencies of the digital filter.
- **Time-Gating Intervals:** Define the start and end times for time-gating.
- **Dispersion Curve Settings:** Choose the number of modes to plot and the material properties.

## Data Acquisition Details

The acoustic emission data analysed by these scripts are obtained from experimental setups or simulations where sensors record the waveforms generated by mechanical events within a material. These events could be due to:

- **Crack Initiation and Propagation:** Emissions resulting from the formation and growth of cracks.
- **Impact Events:** Waves generated by impacts or collisions within the material.
- **Material Defects or Anomalies:** Emissions caused by flaws or irregularities in the material structure.

 Sensor Configuration:

- Multiple sensors are arranged along the specimen to capture wave propagation.
- Sensors may record both in-plane and out-of-plane displacement components.
- The data from each sensor is synchronized in time for accurate analysis.

 Data Format:

- The raw data files (e.g., `V22.mat`) contain time-series data from each sensor.
- Typically, odd columns represent time vectors, and even columns represent amplitude readings from the sensors.
- Data is stored in matrices where rows correspond to time samples and columns correspond to different sensors.

## Data Analysis Steps

### 1. Data Importing and Preprocessing

- **Importing Data:** The `data_import.m` script reads `.mat` files and extracts amplitude arrays and time vectors.
- **Handling Null Values:** Signals with null or missing values are identified. These may occur due to sensor malfunctions or data corruption.
  - **Filtering Null Values:** Affected signals are removed from the analysis to maintain data integrity.
  - **Interpolation:** In cases where minor gaps exist, interpolation may be used to estimate missing values based on neighbouring data.
- **Reformatting Data:** The data is structured into matrices suitable for processing, ensuring that all sensors are properly aligned in time.

### 2. Data Visualization

- **Raw Data Visualization:** The `data_visualization.m` script generates plots to inspect the raw acoustic emission signals.
  - **2D Top-Down View:** Displays amplitude across sensors over time, revealing wave propagation patterns.
  - **3D Surface Plot:** Provides a spatial-temporal view of wave amplitudes.
  - **Time Series Plots:** Shows the signals from the first and last sensors to observe signal changes over distance.

### 3. Signal Filtering

- **Digital Filtering:** The `data_filtering.m` script applies a Butterworth bandpass filter to the data.
  - **Noise Reduction:** Removes unwanted frequencies outside the band of interest, enhancing signal clarity.
  - **Parameter Adjustment:** Filter order and cutoff frequencies can be adjusted based on the specific analysis needs.

### 4. Time-Gating

- **Focusing on Regions of Interest:** The `time_gating.m` script isolates specific time intervals where significant wave activity occurs.
  - **Zeroing Out Data:** Data outside the time window is set to zero, eliminating irrelevant or noisy segments.
  - **Linear Cutoff Adjustment:** End times for time-gating can vary across sensors to account for wave propagation delays.

### 5. Applying Window Functions

- **Hann Window Application:** The `apply_hann_window.m` script applies a Hann window across the spatial domain.
  - **Reducing Spectral Leakage:** Windowing minimizes discontinuities at the data edges, improving FFT results.
  - **Smoothing Data:** Enhances the frequency resolution and accuracy of subsequent analyses.

### 6. 2D FFT Analysis

- **Frequency-Wavenumber Transformation:** The `fft_analysis.m` script performs a 2D FFT on the time-space data.
  - **Revealing Dispersion Characteristics:** Converts data into the frequency-wavenumber domain to analyse wave dispersion.
  - **Plotting FFT Results:** Visualizes the transformed data to identify dominant frequencies and wavenumbers.

### 7. Overlaying Theoretical Dispersion Curves

- **Loading Dispersion Data:** The `plot_dispersion_curves.m` script loads theoretical dispersion curves based on material properties and specimen geometry.
- **Comparing Experimental and Theoretical Data:** Overlays theoretical curves onto FFT results to validate experimental findings.
  - **Mode Identification:** Helps in identifying specific wave modes present in the data.
  - **Discrepancy Analysis:** Any deviations can be studied to understand material behaviour or experimental errors.

### 8. Scaling Matrix Calculation

- **Calculating Scaling Factors:** The `scaling_matrix.m` script computes scaling matrices for in-plane and out-of-plane displacements.
  - **Using Mode Shapes:** Derives scaling factors from theoretical mode shapes and displacement data.
  - **Accounting for Mode Participation:** Adjusts the FFT amplitudes based on how strongly each mode contributes to the overall signal.

### 9. Participating Factor Computation

- **Combining FFT Results and Scaling Matrices:** The `compute_participating_factor.m` script multiplies the FFT amplitudes by the scaling matrices.
- **Quantifying Mode Contributions:** Calculates participating factors to determine the relative contributions of different modes.
- **Result Visualization:** Plots the scaled FFT results to visualize the dominant modes and their frequency-wavenumber relationships.

### 10. Result Interpretation

- **Analyzing Wave Propagation Behavior:** Interprets the participating factors and dispersion characteristics to understand how waves propagate in the material.
- **Identifying Dominant Modes:** Determines which modes are most significant in the wave propagation, which is critical for material characterization.
- **Assessing Material Properties:** Uses the analysis to infer properties such as stiffness, damping, and anisotropy.

## License

This project is licensed under the MIT License.

## Contact

For questions or collaboration, please contact [Sze Kai Low](mailto:lszekai977@gmail,com).
